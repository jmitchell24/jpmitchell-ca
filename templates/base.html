
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title> James Peter Mitchell | {{config.extra.tagline}} </title>
    
    <link rel="preload" href="/fonts/Montserrat-Regular.ttf" as="font" type="font/ttf" crossorigin>
    <link rel="preload" href="/fonts/UbuntuMono-Regular.ttf" as="font" type="font/ttf" crossorigin>

    <link rel="stylesheet" type="text/css" href="/styles.css"/>
    
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="shortcut icon" href="/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="manifest" href="/site.webmanifest" />

    <!-- Matomo -->
    <script>
        var _paq = window._paq = window._paq || [];
        /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
        _paq.push(['trackPageView']);
        _paq.push(['enableLinkTracking']);
        (function() {
            var u="//matomo.delm.win/";
            _paq.push(['setTrackerUrl', u+'matomo.php']);
            _paq.push(['setSiteId', '1']);
            var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
            g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
        })();
    </script>
    <!-- End Matomo Code -->

    <!-- External Links Fix -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
    // Get all links
    const links = document.querySelectorAll('a');

    links.forEach(link => {
            // Check if link is external
            if (link.hostname && link.hostname !== window.location.hostname) {
                link.setAttribute('target', '_blank');
                link.setAttribute('rel', 'noopener noreferrer');
            }
        });
    });
    </script>
    <!-- End External Links Fix -->
</head>
<body>
    {% include "base-header.html"  %}

    {% include "base-aside.html" %}

    {% include "base-nav.html" %}

    <main> 
        <article>
            {% block content %}
            {% endblock content %}
        </article>
    </main>

    {% include "base-footer.html"  %}

    <!-- Link Fixes -->

    <script>
        document.querySelectorAll('*').forEach(item => {
            const url = item.getAttribute('data-internal-href');
            if (url) { 
                item.setAttribute('title', url);
                item.addEventListener('click', (e) => {
                    window.location.href = url; 
                });
            }

            // Make it keyboard accessible
            item.setAttribute('tabindex', '0');
            item.setAttribute('role', 'link');

            item.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    item.click();
                }
            });
        });

        document.querySelectorAll('*').forEach(item => {
            const url = item.getAttribute('data-external-href');
            if (url) { 
                item.setAttribute('title', url);
                item.addEventListener('click', (e) => {
                    window.open(url, '_blank');
                });
                
                // Make it keyboard accessible
                item.setAttribute('tabindex', '0');
                item.setAttribute('role', 'link');
                item.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        item.click();
                    }
                });
            }
        });
    </script>

    <!-- Copy Buttons -->

    <script>
        function addCopyButton2(el) { 
            const pre = el.querySelector("pre"); 
            
            const preLangText = pre.getAttribute("data-lang") || "plaintext"; 
            const preCodeText = pre.textContent || pre.innerText; 

            const footerLang = el.querySelector("code-footer > code-footer-lang"); 
            const footerCopy = el.querySelector("code-footer > code-footer-copy");
            const footerChars = el.querySelector("code-footer > code-footer-chars"); 

            footerLang.innerText = preLangText; 
            footerChars.innerText = `${preCodeText.length} chars`; 
            footerCopy.innerText = "click to copy";

            el.addEventListener('click', async () => {
                try {
                    await navigator.clipboard.writeText(pre.textContent || pre.innerText);
                    
                    // Visual feedback
                    const originalText = footerCopy.innerHTML;
                    footerCopy.innerHTML = "copied...";
                    
                    // Reset after 2 seconds
                    setTimeout(() => {
                        footerCopy.innerHTML = originalText;
                    }, 1500);
                    
                } catch (err) {
                    // Fallback for older browsers
                    // ...
                }
            });
        }
        
        // Function to add copy buttons to all pre elements
        function addCopyButtons() {
            document.querySelectorAll("code-wrapper").forEach((el, idx) => { 
                addCopyButton2(el); 
            });
        }

        // Run when DOM is loaded
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', addCopyButtons);
        } else {
            addCopyButtons();
        }
    </script>

    <!-- Theme Controls -->

    <script>
        const THEME_KEY = "selected-theme"; 

        let current_theme = localStorage.getItem(THEME_KEY) || "alt9"; 
         
        function setTheme(theme) { 
            document.body.setAttribute("data-theme", theme); 

            document.querySelectorAll("theme-switcher-button").forEach(btn => { 
                const btn_theme = btn.getAttribute("data-theme"); 
                if (btn_theme == theme) 
                    btn.classList.add("theme-active"); 
                else 
                    btn.classList.remove("theme-active"); 
            });

            localStorage.setItem(THEME_KEY, theme); 
            current_theme = theme; 
        }

        setTheme(current_theme);
    </script>
</body>
</html>
